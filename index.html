<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COIL CHAMPIONS - Mobile Gaming Hub</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-gold: #FFD700;
            --primary-blue: #1E3A8A;
            --secondary-purple: #8B5CF6;
            --success-green: #10B981;
            --danger-red: #EF4444;
            --dark-bg: #0F172A;
            --card-bg: #1E293B;
            --text-light: #F1F5F9;
            --text-muted: #94A3B8;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--primary-blue) 100%);
            min-height: 100vh;
            color: var(--text-light);
            overflow-x: hidden;
        }
        
        /* Connection Status */
        .connection-status {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--danger-red);
            color: white;
            text-align: center;
            padding: 8px;
            font-size: 14px;
            z-index: 10000;
            transform: translateY(-100%);
            transition: transform 0.3s ease;
        }
        
        .connection-status.show {
            transform: translateY(0);
        }
        
        .connection-status.online {
            background: var(--success-green);
        }
        
        /* Authentication Screens */
        .auth-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--primary-blue) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .auth-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 40px 30px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--primary-gold);
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .auth-logo {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        .auth-title {
            color: var(--primary-gold);
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .auth-subtitle {
            color: var(--text-muted);
            font-size: 14px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            color: var(--text-light);
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
        }
        
        .form-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #374151;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-light);
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary-gold);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);
        }
        
        .form-input::placeholder {
            color: var(--text-muted);
        }
        
        .auth-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary-gold), #FFA500);
            color: var(--dark-bg);
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }
        
        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
        }
        
        .auth-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .auth-switch {
            text-align: center;
            color: var(--text-muted);
            font-size: 14px;
            margin-top: 20px;
        }
        
        .auth-link {
            color: var(--primary-gold);
            cursor: pointer;
            text-decoration: underline;
        }
        
        .guest-btn {
            background: linear-gradient(135deg, var(--secondary-purple), #A855F7);
            margin-top: 10px;
        }
        
        /* Main App Container */
        .app-container {
            display: none;
            min-height: 100vh;
            padding-bottom: 80px;
        }
        
        .app-container.active {
            display: block;
        }
        
        /* Header */
        .app-header {
            background: var(--card-bg);
            padding: 20px;
            border-bottom: 1px solid #374151;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .app-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .app-logo-icon {
            font-size: 32px;
        }
        
        .app-logo-text {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-gold);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .coil-balance {
            background: linear-gradient(135deg, var(--primary-gold), #FFA500);
            color: var(--dark-bg);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--secondary-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            cursor: pointer;
        }
        
        /* Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--card-bg);
            border-top: 1px solid #374151;
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
            min-width: 60px;
        }
        
        .nav-item:hover, .nav-item.active {
            background: rgba(255, 215, 0, 0.1);
            color: var(--primary-gold);
        }
        
        .nav-icon {
            font-size: 24px;
        }
        
        .nav-label {
            font-size: 12px;
            font-weight: 500;
        }
        
        /* Main Content */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Dashboard */
        .welcome-card {
            background: linear-gradient(135deg, var(--secondary-purple), #A855F7);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .welcome-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .welcome-subtitle {
            opacity: 0.9;
            font-size: 16px;
        }
        
        .daily-rewards {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid #374151;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-gold);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rewards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .reward-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .reward-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-gold);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.2);
        }
        
        .reward-card.claimed {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .reward-icon {
            font-size: 36px;
            margin-bottom: 10px;
        }
        
        .reward-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary-gold);
        }
        
        .reward-description {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        /* Games Grid */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .game-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid #374151;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .game-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-gold);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }
        
        .game-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .game-icon {
            font-size: 48px;
        }
        
        .game-info h3 {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-gold);
            margin-bottom: 5px;
        }
        
        .game-cost {
            font-size: 14px;
            color: var(--text-muted);
        }
        
        .game-description {
            color: var(--text-muted);
            line-height: 1.5;
            margin-bottom: 20px;
        }
        
        .play-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, var(--success-green), #059669);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .play-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(16, 185, 129, 0.3);
        }
        
        .play-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Leaderboards */
        .leaderboard-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .leaderboard-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid #374151;
        }
        
        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .leaderboard-item:hover {
            background: rgba(255, 215, 0, 0.1);
        }
        
        .leaderboard-item.first {
            background: linear-gradient(135deg, var(--primary-gold), #FFA500);
            color: var(--dark-bg);
        }
        
        .leaderboard-item.second {
            background: linear-gradient(135deg, #C0C0C0, #A8A8A8);
        }
        
        .leaderboard-item.third {
            background: linear-gradient(135deg, #CD7F32, #B8860B);
        }
        
        .rank-number {
            font-size: 18px;
            font-weight: 700;
            min-width: 30px;
        }
        
        .player-info {
            flex: 1;
        }
        
        .player-name {
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .player-score {
            font-size: 14px;
            opacity: 0.8;
        }
        
        /* Game Screens */
        .game-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--primary-blue) 100%);
            z-index: 500;
            display: none;
            overflow-y: auto;
        }
        
        .game-screen.active {
            display: block;
            animation: slideInRight 0.3s ease-out;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .game-header-bar {
            background: var(--card-bg);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid #374151;
        }
        
        .back-btn {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 24px;
            cursor: pointer;
            padding: 5px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .game-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-gold);
        }
        
        .game-content {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* Lucky Spin */
        .spin-container {
            text-align: center;
            padding: 20px 0;
        }
        
        .spin-wheel {
            width: 280px;
            height: 280px;
            border: 8px solid var(--primary-gold);
            border-radius: 50%;
            margin: 30px auto;
            position: relative;
            background: conic-gradient(
                #FF6B6B 0deg 45deg,
                #4ECDC4 45deg 90deg,
                #45B7D1 90deg 135deg,
                #96CEB4 135deg 180deg,
                #FECA57 180deg 225deg,
                #FF9FF3 225deg 270deg,
                #A8E6CF 270deg 315deg,
                #FFD93D 315deg 360deg
            );
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.4);
            transition: transform 4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .spin-wheel::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle, var(--primary-gold), #FFA500);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
        }
        
        .spin-pointer {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-top: 25px solid var(--primary-gold);
            z-index: 5;
        }
        
        .wheel-segments {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }
        
        .wheel-segment {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 50%;
            height: 2px;
            transform-origin: left center;
            color: white;
            font-weight: 600;
            font-size: 11px;
            display: flex;
            align-items: center;
            padding-left: 15px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
        }
        
        .spin-btn {
            background: linear-gradient(135deg, var(--primary-gold), #FFA500);
            color: var(--dark-bg);
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0;
        }
        
        .spin-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.4);
        }
        
        .spin-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .spin-result {
            margin-top: 20px;
            font-size: 18px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Math Pro Game */
        .math-container {
            text-align: center;
            padding: 20px 0;
        }
        
        .math-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid #374151;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-gold);
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 5px;
        }
        
        .math-question {
            font-size: 36px;
            font-weight: 700;
            color: var(--primary-gold);
            margin: 40px 0;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .math-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .math-option {
            padding: 20px;
            background: var(--card-bg);
            color: var(--text-light);
            border: 2px solid #374151;
            border-radius: 15px;
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .math-option:hover {
            border-color: var(--primary-gold);
            transform: translateY(-2px);
        }
        
        .math-option.correct {
            background: var(--success-green);
            border-color: var(--success-green);
        }
        
        .math-option.incorrect {
            background: var(--danger-red);
            border-color: var(--danger-red);
        }
        
        /* Venus Fortune */
        .fortune-container {
            text-align: center;
            padding: 20px 0;
        }
        
        .fortune-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 30px 0;
        }
        
        .fortune-card {
            aspect-ratio: 3/4;
            background: linear-gradient(135deg, var(--secondary-purple), #A855F7);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }
        
        .fortune-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-gold);
            box-shadow: 0 10px 20px rgba(139, 92, 246, 0.3);
        }
        
        .fortune-card.revealed {
            background: var(--card-bg);
            cursor: not-allowed;
        }
        
        /* Point King */
        .point-king-container {
            text-align: center;
            padding: 20px 0;
        }
        
        .point-display {
            font-size: 48px;
            font-weight: 700;
            color: var(--primary-gold);
            margin: 30px 0;
        }
        
        .point-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .click-btn {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-gold), #FFA500);
            color: var(--dark-bg);
            border: none;
            font-size: 24px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.1s ease;
            margin: 20px auto;
            display: block;
        }
        
        .click-btn:active {
            transform: scale(0.95);
        }
        
        /* Lucky Number */
        .number-container {
            text-align: center;
            padding: 20px 0;
        }
        
        .number-input {
            width: 200px;
            padding: 15px;
            font-size: 24px;
            text-align: center;
            border: 2px solid #374151;
            border-radius: 12px;
            background: var(--card-bg);
            color: var(--text-light);
            margin: 20px 0;
        }
        
        .number-input:focus {
            outline: none;
            border-color: var(--primary-gold);
        }
        
        .guess-btn {
            background: linear-gradient(135deg, var(--success-green), #059669);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .guess-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(16, 185, 129, 0.3);
        }
        
        /* Profile Screen */
        .profile-container {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .profile-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--secondary-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            margin: 0 auto 20px;
            border: 4px solid var(--primary-gold);
        }
        
        .profile-name {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-gold);
            margin-bottom: 5px;
        }
        
        .profile-email {
            color: var(--text-muted);
            font-size: 14px;
        }
        
        .profile-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .profile-stat {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid #374151;
        }
        
        .profile-actions {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .profile-btn {
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .profile-btn.primary {
            background: linear-gradient(135deg, var(--primary-gold), #FFA500);
            color: var(--dark-bg);
        }
        
        .profile-btn.danger {
            background: linear-gradient(135deg, var(--danger-red), #DC2626);
            color: white;
        }
        
        /* Chat Screen */
        .chat-container {
            height: calc(100vh - 140px);
            display: flex;
            flex-direction: column;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: var(--card-bg);
            margin-bottom: 20px;
            border-radius: 15px;
        }
        
        .chat-message {
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .chat-message.own {
            background: var(--secondary-purple);
            margin-left: 20%;
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .message-author {
            font-weight: 600;
            color: var(--primary-gold);
            font-size: 14px;
        }
        
        .message-time {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        .message-content {
            color: var(--text-light);
            line-height: 1.4;
        }
        
        .chat-input-container {
            display: flex;
            gap: 10px;
        }
        
        .chat-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #374151;
            border-radius: 12px;
            background: var(--card-bg);
            color: var(--text-light);
            font-size: 16px;
        }
        
        .chat-input:focus {
            outline: none;
            border-color: var(--primary-gold);
        }
        
        .send-btn {
            background: linear-gradient(135deg, var(--success-green), #059669);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
        }
        
        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-green);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            font-weight: 600;
            z-index: 10000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 300px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            background: var(--danger-red);
        }
        
        .notification.warning {
            background: #F59E0B;
        }
        
        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-gold);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Ad Modal */
        .ad-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        
        .ad-content {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        
        .ad-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-gold);
            margin-bottom: 20px;
        }
        
        .ad-timer {
            font-size: 48px;
            font-weight: 700;
            color: var(--success-green);
            margin: 30px 0;
        }
        
        .ad-skip {
            background: var(--text-muted);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .ad-skip:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .leaderboard-container {
                grid-template-columns: 1fr;
            }
            
            .rewards-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .redeem-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .balance-display {
                flex-direction: column;
                gap: 10px;
            }
            
            .math-options {
                grid-template-columns: 1fr;
            }
            
            .fortune-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .spin-wheel {
                width: 240px;
                height: 240px;
            }
            
            .click-btn {
                width: 150px;
                height: 150px;
                font-size: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .auth-card {
                padding: 30px 20px;
            }
            
            .main-content {
                padding: 15px;
            }
            
            .game-content {
                padding: 15px;
            }
            
            .rewards-grid {
                grid-template-columns: 1fr;
            }
            
            .redeem-grid {
                grid-template-columns: 1fr;
            }
            
            .math-stats {
                grid-template-columns: 1fr;
            }
            
            .point-stats {
                grid-template-columns: 1fr;
            }
        }
        
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Connection Status -->
    <div class="connection-status" id="connectionStatus">
        🔴 No Internet Connection - Some features may not work
    </div>

    <!-- Authentication Container -->
    <div class="auth-container" id="authContainer">
        <div class="auth-card">
            <div class="auth-header">
                <div class="auth-logo">🎮</div>
                <h1 class="auth-title" id="authTitle">Welcome to Coil Champions</h1>
                <p class="auth-subtitle" id="authSubtitle">Your ultimate mobile gaming hub</p>
            </div>
            
            <form id="authForm">
                <div class="form-group">
                    <label class="form-label" for="email">Email Address</label>
                    <input type="email" class="form-input" id="email" placeholder="Enter your Gmail address" required>
                </div>
                
                <div class="form-group" id="kpayGroup">
                    <label class="form-label" for="kpay">KPay Number</label>
                    <input type="tel" class="form-input" id="kpay" placeholder="Enter your KPay number">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="password">Password</label>
                    <input type="password" class="form-input" id="password" placeholder="Enter your password" required>
                </div>
                
                <div class="form-group hidden" id="confirmPasswordGroup">
                    <label class="form-label" for="confirmPassword">Confirm Password</label>
                    <input type="password" class="form-input" id="confirmPassword" placeholder="Confirm your password">
                </div>
                
                <button type="submit" class="auth-btn" id="authSubmit">
                    <span id="authBtnText">Sign In</span>
                    <div class="loading hidden" id="authLoading"></div>
                </button>
                
                <button type="button" class="auth-btn guest-btn" onclick="guestLogin()">
                    🚀 Play as Guest
                </button>
            </form>
            
            <div class="auth-switch">
                <span id="authSwitchText">Don't have an account?</span>
                <span class="auth-link" id="authSwitchLink" onclick="toggleAuthMode()">Sign Up</span>
            </div>
            
            <div class="auth-switch" style="margin-top: 10px;">
                <span class="auth-link" onclick="showPasswordReset()">Forgot Password?</span>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div class="app-container" id="appContainer">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="app-logo">
                    <span class="app-logo-icon">🎮</span>
                    <span class="app-logo-text">Coil Champions</span>
                </div>
                
                <div class="user-info">
                    <div class="coil-balance">
                        <span>💰</span>
                        <span id="coilBalance">1000</span>
                    </div>
                    <div class="user-avatar" onclick="showScreen('profile')">
                        <span id="userAvatar">👤</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Screen -->
            <div class="screen active" id="dashboardScreen">
                <div class="welcome-card">
                    <h2 class="welcome-title">Welcome back, <span id="welcomeUser">Champion</span>!</h2>
                    <p class="welcome-subtitle">Ready to earn some coils and climb the leaderboards?</p>
                </div>

                <!-- Daily Rewards -->
                <section class="daily-rewards">
                    <h3 class="section-title">
                        <span>🎁</span>
                        Daily Rewards
                    </h3>
                    <div class="rewards-grid">
                        <div class="reward-card" onclick="claimDailyLogin()">
                            <div class="reward-icon">📅</div>
                            <div class="reward-title">Daily Login</div>
                            <div class="reward-description">+100 Coils</div>
                        </div>
                        <div class="reward-card" onclick="watchRewardAd()">
                            <div class="reward-icon">📺</div>
                            <div class="reward-title">Watch Ad</div>
                            <div class="reward-description">+50 Coils</div>
                        </div>
                        <div class="reward-card" onclick="showGame('luckySpin')">
                            <div class="reward-icon">🎰</div>
                            <div class="reward-title">Lucky Spin</div>
                            <div class="reward-description">Win Big!</div>
                        </div>
                        <div class="reward-card" onclick="inviteFriend()">
                            <div class="reward-icon">👥</div>
                            <div class="reward-title">Invite Friend</div>
                            <div class="reward-description">+200 Coils</div>
                        </div>
                    </div>
                </section>

                <!-- Featured Games -->
                <section>
                    <h3 class="section-title">
                        <span>🎯</span>
                        Featured Games
                    </h3>
                    <div class="games-grid">
                        <div class="game-card" onclick="showGame('luckySpin')">
                            <div class="game-header">
                                <div class="game-icon">🎰</div>
                                <div class="game-info">
                                    <h3>Lucky Spin</h3>
                                    <div class="game-cost">100 Coils + Ad</div>
                                </div>
                            </div>
                            <p class="game-description">Spin the wheel of fortune and win amazing prizes! Watch an ad to unlock bigger rewards.</p>
                            <button class="play-btn">Play Now</button>
                        </div>

                        <div class="game-card" onclick="showGame('mathPro')">
                            <div class="game-header">
                                <div class="game-icon">🧮</div>
                                <div class="game-info">
                                    <h3>Math Pro</h3>
                                    <div class="game-cost">50 Coils per round</div>
                                </div>
                            </div>
                            <p class="game-description">Test your math skills with increasingly difficult problems. Earn coils for correct answers!</p>
                            <button class="play-btn">Play Now</button>
                        </div>

                        <div class="game-card" onclick="showGame('venusFortune')">
                            <div class="game-header">
                                <div class="game-icon">🔮</div>
                                <div class="game-info">
                                    <h3>Venus Fortune</h3>
                                    <div class="game-cost">100 Coils + Ad</div>
                                </div>
                            </div>
                            <p class="game-description">Choose your fortune from hidden cards. One correct choice among many - will luck be on your side?</p>
                            <button class="play-btn">Play Now</button>
                        </div>

                        <div class="game-card" onclick="showGame('pointKing')">
                            <div class="game-header">
                                <div class="game-icon">👑</div>
                                <div class="game-info">
                                    <h3>Point King</h3>
                                    <div class="game-cost">60 Coils per session</div>
                                </div>
                            </div>
                            <p class="game-description">Accumulate points through rapid clicking and combos. Compete for the crown!</p>
                            <button class="play-btn">Play Now</button>
                        </div>

                        <div class="game-card" onclick="showGame('luckyNumber')">
                            <div class="game-header">
                                <div class="game-icon">🔢</div>
                                <div class="game-info">
                                    <h3>Lucky Number</h3>
                                    <div class="game-cost">100 Coils per guess</div>
                                </div>
                            </div>
                            <p class="game-description">Guess the lucky number between 1-100. Resets every 12 hours with new prizes!</p>
                            <button class="play-btn">Play Now</button>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Games Screen -->
            <div class="screen" id="gamesScreen">
                <h2 class="section-title">
                    <span>🎮</span>
                    All Games
                </h2>
                <div class="games-grid">
                    <!-- Games will be populated here -->
                </div>
            </div>

            <!-- Leaderboards Screen -->
            <div class="screen" id="leaderboardsScreen">
                <h2 class="section-title">
                    <span>🏆</span>
                    Leaderboards
                </h2>
                <div class="leaderboard-container">
                    <div class="leaderboard-card">
                        <h3 class="section-title">
                            <span>🧮</span>
                            Math Pro Champions
                        </h3>
                        <div id="mathLeaderboard">
                            <div class="leaderboard-item first">
                                <span class="rank-number">1</span>
                                <div class="player-info">
                                    <div class="player-name">MathWizard2024</div>
                                    <div class="player-score">15,420 points</div>
                                </div>
                            </div>
                            <div class="leaderboard-item second">
                                <span class="rank-number">2</span>
                                <div class="player-info">
                                    <div class="player-name">NumberNinja</div>
                                    <div class="player-score">12,890 points</div>
                                </div>
                            </div>
                            <div class="leaderboard-item third">
                                <span class="rank-number">3</span>
                                <div class="player-info">
                                    <div class="player-name">CalcMaster</div>
                                    <div class="player-score">11,750 points</div>
                                </div>
                            </div>
                            <div class="leaderboard-item">
                                <span class="rank-number">4</span>
                                <div class="player-info">
                                    <div class="player-name">You</div>
                                    <div class="player-score" id="userMathScore">0 points</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="leaderboard-card">
                        <h3 class="section-title">
                            <span>👑</span>
                            Point Kings
                        </h3>
                        <div id="pointLeaderboard">
                            <div class="leaderboard-item first">
                                <span class="rank-number">1</span>
                                <div class="player-info">
                                    <div class="player-name">ClickMaster</div>
                                    <div class="player-score">89,500 points</div>
                                </div>
                            </div>
                            <div class="leaderboard-item second">
                                <span class="rank-number">2</span>
                                <div class="player-info">
                                    <div class="player-name">SpeedClicker</div>
                                    <div class="player-score">76,230 points</div>
                                </div>
                            </div>
                            <div class="leaderboard-item third">
                                <span class="rank-number">3</span>
                                <div class="player-info">
                                    <div class="player-name">RapidFire</div>
                                    <div class="player-score">68,940 points</div>
                                </div>
                            </div>
                            <div class="leaderboard-item">
                                <span class="rank-number">4</span>
                                <div class="player-info">
                                    <div class="player-name">You</div>
                                    <div class="player-score" id="userPointScore">0 points</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="leaderboard-card">
                        <h3 class="section-title">
                            <span>🔢</span>
                            Lucky Number Winners
                        </h3>
                        <div id="luckyNumberLeaderboard">
                            <div class="leaderboard-item first">
                                <span class="rank-number">1</span>
                                <div class="player-info">
                                    <div class="player-name">LuckyGuess</div>
                                    <div class="player-score">5 wins</div>
                                </div>
                            </div>
                            <div class="leaderboard-item second">
                                <span class="rank-number">2</span>
                                <div class="player-info">
                                    <div class="player-name">NumberSeer</div>
                                    <div class="player-score">3 wins</div>
                                </div>
                            </div>
                            <div class="leaderboard-item third">
                                <span class="rank-number">3</span>
                                <div class="player-info">
                                    <div class="player-name">FortuneHunter</div>
                                    <div class="player-score">2 wins</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Screen -->
            <div class="screen" id="profileScreen">
                <div class="profile-container">
                    <div class="profile-header">
                        <div class="profile-avatar">
                            <span id="profileAvatar">👤</span>
                        </div>
                        <h2 class="profile-name" id="profileName">Champion Player</h2>
                        <p class="profile-email" id="profileEmail">player@example.com</p>
                    </div>

                    <div class="profile-stats">
                        <div class="profile-stat">
                            <div class="stat-value" id="totalCoils">1000</div>
                            <div class="stat-label">Total Coils</div>
                        </div>
                        <div class="profile-stat">
                            <div class="stat-value" id="gamesPlayed">0</div>
                            <div class="stat-label">Games Played</div>
                        </div>
                        <div class="profile-stat">
                            <div class="stat-value" id="totalWins">0</div>
                            <div class="stat-label">Total Wins</div>
                        </div>
                        <div class="profile-stat">
                            <div class="stat-value" id="loginStreak">1</div>
                            <div class="stat-label">Login Streak</div>
                        </div>
                    </div>

                    <div class="profile-actions">
                        <button class="profile-btn primary" onclick="editProfile()">
                            ✏️ Edit Profile
                        </button>
                        <button class="profile-btn primary" onclick="changePassword()">
                            🔒 Change Password
                        </button>
                        <button class="profile-btn primary" onclick="viewGameHistory()">
                            📊 Game History
                        </button>
                        <button class="profile-btn danger" onclick="logout()">
                            🚪 Logout
                        </button>
                    </div>
                </div>
            </div>

            <!-- Chat Screen -->
            <div class="screen" id="chatScreen">
                <h2 class="section-title">
                    <span>💬</span>
                    Global Chat
                </h2>
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-message">
                            <div class="message-header">
                                <span class="message-author">GameMaster</span>
                                <span class="message-time">2 min ago</span>
                            </div>
                            <div class="message-content">Welcome to Coil Champions! Good luck everyone! 🎮</div>
                        </div>
                        <div class="chat-message">
                            <div class="message-header">
                                <span class="message-author">MathWizard2024</span>
                                <span class="message-time">1 min ago</span>
                            </div>
                            <div class="message-content">Just hit a new high score in Math Pro! 🧮✨</div>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" class="chat-input" id="chatInput" placeholder="Type your message..." maxlength="200">
                        <button class="send-btn" onclick="sendMessage()">Send</button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <div class="nav-item active" onclick="showScreen('dashboard')">
                <div class="nav-icon">🏠</div>
                <div class="nav-label">Home</div>
            </div>
            <div class="nav-item" onclick="showScreen('games')">
                <div class="nav-icon">🎮</div>
                <div class="nav-label">Games</div>
            </div>
            <div class="nav-item" onclick="showScreen('leaderboards')">
                <div class="nav-icon">🏆</div>
                <div class="nav-label">Rankings</div>
            </div>
            <div class="nav-item" onclick="showScreen('chat')">
                <div class="nav-icon">💬</div>
                <div class="nav-label">Chat</div>
            </div>
            <div class="nav-item" onclick="showScreen('profile')">
                <div class="nav-icon">👤</div>
                <div class="nav-label">Profile</div>
            </div>
        </nav>
    </div>

    <!-- Game Screens -->
    <!-- Lucky Spin Game -->
    <div class="game-screen" id="luckySpinGame">
        <div class="game-header-bar">
            <button class="back-btn" onclick="closeGame()">←</button>
            <h2 class="game-title">🎰 Lucky Spin</h2>
        </div>
        <div class="game-content">
            <div class="spin-container">
                <div class="spin-wheel" id="spinWheel">
                    <div class="spin-pointer"></div>
                    <div class="wheel-segments">
                        <div class="wheel-segment" style="transform: rotate(0deg);">JACKPOT</div>
                        <div class="wheel-segment" style="transform: rotate(45deg);">500</div>
                        <div class="wheel-segment" style="transform: rotate(90deg);">300</div>
                        <div class="wheel-segment" style="transform: rotate(135deg);">200</div>
                        <div class="wheel-segment" style="transform: rotate(180deg);">150</div>
                        <div class="wheel-segment" style="transform: rotate(225deg);">100</div>
                        <div class="wheel-segment" style="transform: rotate(270deg);">50</div>
                        <div class="wheel-segment" style="transform: rotate(315deg);">25</div>
                    </div>
                </div>
                <button class="spin-btn" id="spinBtn" onclick="startSpin()">
                    SPIN THE WHEEL! (100 Coils)
                </button>
                <div class="spin-result" id="spinResult"></div>
                <div style="color: var(--text-muted); text-align: center; margin-top: 20px;">
                    <p>🎯 Watch an ad before spinning for better prizes!</p>
                    <p>💰 Higher coil cost = Better rewards</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Math Pro Game -->
    <div class="game-screen" id="mathProGame">
        <div class="game-header-bar">
            <button class="back-btn" onclick="closeGame()">←</button>
            <h2 class="game-title">🧮 Math Pro</h2>
        </div>
        <div class="game-content">
            <div class="math-container">
                <div class="math-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="mathCurrentScore">0</div>
                        <div class="stat-label">Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="mathStreak">0</div>
                        <div class="stat-label">Streak</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="mathTimer">15</div>
                        <div class="stat-label">Time</div>
                    </div>
                </div>
                
                <div class="math-question" id="mathQuestion">
                    Click "Start Game" to begin!
                </div>
                
                <div class="math-options" id="mathOptions">
                    <button class="math-option" onclick="startMathGame()">Start Game (50 Coils)</button>
                    <button class="math-option" onclick="closeGame()">Back to Menu</button>
                </div>
                
                <div style="color: var(--text-muted); text-align: center; margin-top: 20px;">
                    <p>🧠 Solve problems quickly for bonus points!</p>
                    <p>⚡ Build streaks for multiplier bonuses</p>
                    <p>📈 Difficulty increases as you progress</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Venus Fortune Game -->
    <div class="game-screen" id="venusFortuneGame">
        <div class="game-header-bar">
            <button class="back-btn" onclick="closeGame()">←</button>
            <h2 class="game-title">🔮 Venus Fortune</h2>
        </div>
        <div class="game-content">
            <div class="fortune-container">
                <h3 style="text-align: center; color: var(--primary-gold); margin-bottom: 20px;">
                    Choose Your Fortune
                </h3>
                <p style="text-align: center; color: var(--text-muted); margin-bottom: 30px;">
                    One card holds your prize. Choose wisely!
                </p>
                
                <div class="fortune-cards" id="fortuneCards">
                    <div class="fortune-card" onclick="selectFortuneCard(0)">🔮</div>
                    <div class="fortune-card" onclick="selectFortuneCard(1)">🔮</div>
                    <div class="fortune-card" onclick="selectFortuneCard(2)">🔮</div>
                    <div class="fortune-card" onclick="selectFortuneCard(3)">🔮</div>
                    <div class="fortune-card" onclick="selectFortuneCard(4)">🔮</div>
                    <div class="fortune-card" onclick="selectFortuneCard(5)">🔮</div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="spin-btn" onclick="startVenusFortune()">
                        Play Fortune (100 Coils)
                    </button>
                </div>
                
                <div id="fortuneResult" style="text-align: center; margin-top: 20px; min-height: 60px;"></div>
                
                <div style="color: var(--text-muted); text-align: center; margin-top: 20px;">
                    <p>🔮 Watch an ad to reveal your chosen card</p>
                    <p>✨ Only one card contains the winning prize</p>
                    <p>🎁 Prizes reset every hour</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Point King Game -->
    <div class="game-screen" id="pointKingGame">
        <div class="game-header-bar">
            <button class="back-btn" onclick="closeGame()">←</button>
            <h2 class="game-title">👑 Point King</h2>
        </div>
        <div class="game-content">
            <div class="point-king-container">
                <div class="point-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="pointKingScore">0</div>
                        <div class="stat-label">Points</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="pointKingMultiplier">x1</div>
                        <div class="stat-label">Multiplier</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="pointKingTime">30</div>
                        <div class="stat-label">Time</div>
                    </div>
                </div>
                
                <div class="point-display" id="pointDisplay">
                    Click to Start!
                </div>
                
                <button class="click-btn" id="clickBtn" onclick="startPointKing()">
                    START GAME
                </button>
                
                <div style="color: var(--text-muted); text-align: center; margin-top: 20px;">
                    <p>👆 Click rapidly to accumulate points</p>
                    <p>⚡ Build combos for multiplier bonuses</p>
                    <p>🎯 Watch for power-ups and critical hits</p>
                    <p>⌨️ Use SPACEBAR for faster clicking</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Lucky Number Game -->
    <div class="game-screen" id="luckyNumberGame">
        <div class="game-header-bar">
            <button class="back-btn" onclick="closeGame()">←</button>
            <h2 class="game-title">🔢 Lucky Number</h2>
        </div>
        <div class="game-content">
            <div class="number-container">
                <h3 style="text-align: center; color: var(--primary-gold); margin-bottom: 20px;">
                    Guess the Lucky Number!
                </h3>
                <p style="text-align: center; color: var(--text-muted); margin-bottom: 30px;">
                    Number is between 1 and 100
                </p>
                
                <div style="text-align: center;">
                    <input type="number" class="number-input" id="numberGuess" min="1" max="100" placeholder="Enter your guess">
                    <br>
                    <button class="guess-btn" onclick="makeGuess()">
                        Make Guess (100 Coils)
                    </button>
                </div>
                
                <div id="guessResult" style="text-align: center; margin-top: 30px; min-height: 60px;"></div>
                
                <div style="color: var(--text-muted); text-align: center; margin-top: 30px;">
                    <p>🎯 One guess per round</p>
                    <p>🔄 Number resets every 12 hours</p>
                    <p>🏆 Winners appear on leaderboard</p>
                    <p>💰 Jackpot grows with each wrong guess</p>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <div style="background: var(--card-bg); padding: 15px; border-radius: 12px; border: 1px solid #374151;">
                        <div style="color: var(--primary-gold); font-weight: 600;">Current Jackpot</div>
                        <div style="font-size: 24px; font-weight: 700; color: var(--success-green);" id="jackpotAmount">5,000 Coils</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ad Modal -->
    <div class="ad-modal" id="adModal">
        <div class="ad-content">
            <h3 class="ad-title">Watch Advertisement</h3>
            <p style="color: var(--text-muted); margin-bottom: 20px;">
                Watch this short ad to unlock your reward!
            </p>
            <div class="ad-timer" id="adTimer">5</div>
            <button class="ad-skip" id="adSkip" onclick="skipAd()" disabled>
                Skip Ad
            </button>
        </div>
    </div>

    <script>
        // Game State Management
        const gameState = {
            user: {
                id: null,
                email: '',
                username: '',
                kpay: '',
                coils: 1000,
                avatar: '👤',
                isGuest: false,
                loginStreak: 1,
                lastLogin: null
            },
            stats: {
                gamesPlayed: 0,
                totalWins: 0,
                mathScore: 0,
                pointScore: 0,
                luckyNumberWins: 0
            },
            dailyRewards: {
                loginClaimed: false,
                lastClaimDate: null
            },
            redemptions: {
                history: [],
                totalRedeemed: 0
            },
            currentGame: null,
            isOnline: navigator.onLine,
            authMode: 'login' // 'login' or 'register'
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            checkConnection();
            loadUserData();
            setupEventListeners();
            
            // Check connection status
            window.addEventListener('online', () => {
                gameState.isOnline = true;
                updateConnectionStatus();
            });
            
            window.addEventListener('offline', () => {
                gameState.isOnline = false;
                updateConnectionStatus();
            });
        });

        // Connection Management
        function checkConnection() {
            gameState.isOnline = navigator.onLine;
            updateConnectionStatus();
        }

        function updateConnectionStatus() {
            const statusEl = document.getElementById('connectionStatus');
            if (gameState.isOnline) {
                statusEl.textContent = '🟢 Connected - All features available';
                statusEl.className = 'connection-status online';
                setTimeout(() => statusEl.classList.remove('show'), 2000);
            } else {
                statusEl.textContent = '🔴 No Internet Connection - Some features may not work';
                statusEl.className = 'connection-status show';
            }
        }

        // Authentication System
        function setupEventListeners() {
            document.getElementById('authForm').addEventListener('submit', handleAuth);
            document.getElementById('chatInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendMessage();
            });
        }

        function toggleAuthMode() {
            gameState.authMode = gameState.authMode === 'login' ? 'register' : 'login';
            updateAuthUI();
        }

        function updateAuthUI() {
            const isLogin = gameState.authMode === 'login';
            
            document.getElementById('authTitle').textContent = isLogin ? 'Welcome Back!' : 'Join Coil Champions';
            document.getElementById('authSubtitle').textContent = isLogin ? 'Sign in to continue your journey' : 'Create your account and start playing';
            document.getElementById('authBtnText').textContent = isLogin ? 'Sign In' : 'Create Account';
            document.getElementById('authSwitchText').textContent = isLogin ? "Don't have an account?" : "Already have an account?";
            document.getElementById('authSwitchLink').textContent = isLogin ? 'Sign Up' : 'Sign In';
            
            document.getElementById('kpayGroup').classList.toggle('hidden', isLogin);
            document.getElementById('confirmPasswordGroup').classList.toggle('hidden', isLogin);
        }

        async function handleAuth(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const kpay = document.getElementById('kpay').value;
            
            if (gameState.authMode === 'register') {
                const confirmPassword = document.getElementById('confirmPassword').value;
                if (password !== confirmPassword) {
                    showNotification('Passwords do not match!', 'error');
                    return;
                }
            }

            // Show loading
            document.getElementById('authLoading').classList.remove('hidden');
            document.getElementById('authBtnText').classList.add('hidden');
            document.getElementById('authSubmit').disabled = true;

            // Simulate API call
            setTimeout(() => {
                if (gameState.authMode === 'login') {
                    loginUser(email, password);
                } else {
                    registerUser(email, password, kpay);
                }
            }, 1500);
        }

        function loginUser(email, password) {
            // Simulate login validation
            gameState.user.email = email;
            gameState.user.username = email.split('@')[0];
            gameState.user.id = 'user_' + Date.now();
            gameState.user.isGuest = false;
            
            completeAuth();
            showNotification(`Welcome back, ${gameState.user.username}!`, 'success');
        }

        function registerUser(email, password, kpay) {
            // Simulate registration
            gameState.user.email = email;
            gameState.user.username = email.split('@')[0];
            gameState.user.kpay = kpay;
            gameState.user.id = 'user_' + Date.now();
            gameState.user.coils = 1500; // Bonus for new users
            gameState.user.isGuest = false;
            
            completeAuth();
            showNotification(`Welcome to Coil Champions, ${gameState.user.username}! You received 500 bonus coils!`, 'success');
        }

        function guestLogin() {
            gameState.user.username = 'Guest_' + Math.floor(Math.random() * 1000);
            gameState.user.email = 'guest@coilchampions.com';
            gameState.user.id = 'guest_' + Date.now();
            gameState.user.coils = 2000; // Extra coils for guests
            gameState.user.isGuest = true;
            gameState.user.avatar = '🎮';
            
            completeAuth();
            showNotification(`Welcome ${gameState.user.username}! You received 2000 coils to get started!`, 'success');
        }

        function completeAuth() {
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('appContainer').classList.add('active');
            
            updateUserUI();
            saveUserData();
            
            // Reset auth form
            document.getElementById('authLoading').classList.add('hidden');
            document.getElementById('authBtnText').classList.remove('hidden');
            document.getElementById('authSubmit').disabled = false;
        }

        function showPasswordReset() {
            const email = prompt('Enter your email address for password reset:');
            if (email) {
                showNotification('Password reset link sent to your email!', 'success');
            }
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                // Reset game state
                gameState.user = {
                    id: null,
                    email: '',
                    username: '',
                    kpay: '',
                    coils: 1000,
                    avatar: '👤',
                    isGuest: false,
                    loginStreak: 1,
                    lastLogin: null
                };
                
                document.getElementById('appContainer').classList.remove('active');
                document.getElementById('authContainer').style.display = 'flex';
                
                // Reset forms
                document.getElementById('email').value = '';
                document.getElementById('password').value = '';
                document.getElementById('confirmPassword').value = '';
                document.getElementById('kpay').value = '';
                
                showNotification('Logged out successfully!', 'success');
            }
        }

        // UI Updates
        function updateUserUI() {
            document.getElementById('welcomeUser').textContent = gameState.user.username;
            document.getElementById('coilBalance').textContent = gameState.user.coils.toLocaleString();
            document.getElementById('userAvatar').textContent = gameState.user.avatar;
            document.getElementById('profileAvatar').textContent = gameState.user.avatar;
            document.getElementById('profileName').textContent = gameState.user.username;
            document.getElementById('profileEmail').textContent = gameState.user.email;
            document.getElementById('totalCoils').textContent = gameState.user.coils.toLocaleString();
            document.getElementById('gamesPlayed').textContent = gameState.stats.gamesPlayed;
            document.getElementById('totalWins').textContent = gameState.stats.totalWins;
            document.getElementById('loginStreak').textContent = gameState.user.loginStreak;
            document.getElementById('userMathScore').textContent = gameState.stats.mathScore + ' points';
            document.getElementById('userPointScore').textContent = gameState.stats.pointScore + ' points';
            
            // Update redeem screen balance
            if (document.getElementById('redeemBalance')) {
                document.getElementById('redeemBalance').textContent = gameState.user.coils.toLocaleString();
                updateRedeemCards();
            }
        }

        // Navigation
        function showScreen(screenName) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show selected screen
            document.getElementById(screenName + 'Screen').classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            event.currentTarget.classList.add('active');
        }

        function showGame(gameName) {
            // Hide main app
            document.getElementById('appContainer').style.display = 'none';
            
            // Show game screen
            document.getElementById(gameName + 'Game').classList.add('active');
            gameState.currentGame = gameName;
        }

        function closeGame() {
            // Hide all game screens
            document.querySelectorAll('.game-screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show main app
            document.getElementById('appContainer').style.display = 'block';
            gameState.currentGame = null;
            
            // Reset any game timers
            if (window.gameTimer) {
                clearInterval(window.gameTimer);
                window.gameTimer = null;
            }
        }

        // Daily Rewards
        function claimDailyLogin() {
            const today = new Date().toDateString();
            
            if (gameState.dailyRewards.lastClaimDate === today) {
                showNotification('Daily login bonus already claimed today!', 'warning');
                return;
            }
            
            gameState.user.coils += 100;
            gameState.dailyRewards.lastClaimDate = today;
            gameState.dailyRewards.loginClaimed = true;
            
            // Update login streak
            const lastLogin = new Date(gameState.user.lastLogin);
            const now = new Date();
            const daysDiff = Math.floor((now - lastLogin) / (1000 * 60 * 60 * 24));
            
            if (daysDiff === 1) {
                gameState.user.loginStreak++;
            } else if (daysDiff > 1) {
                gameState.user.loginStreak = 1;
            }
            
            gameState.user.lastLogin = now.toISOString();
            
            updateUserUI();
            saveUserData();
            showNotification(`Daily login bonus claimed! +100 Coils (Streak: ${gameState.user.loginStreak})`, 'success');
        }

        function watchRewardAd() {
            showAd(() => {
                gameState.user.coils += 50;
                updateUserUI();
                saveUserData();
                showNotification('Ad reward claimed! +50 Coils', 'success');
            });
        }

        function inviteFriend() {
            if (navigator.share) {
                navigator.share({
                    title: 'Join me in Coil Champions!',
                    text: 'Play amazing games and earn coils with me!',
                    url: window.location.href
                });
            } else {
                // Fallback for browsers without Web Share API
                const shareText = `Join me in Coil Champions! Play amazing games and earn coils. ${window.location.href}`;
                navigator.clipboard.writeText(shareText).then(() => {
                    showNotification('Invite link copied to clipboard!', 'success');
                });
            }
            
            // Simulate friend invitation reward
            setTimeout(() => {
                gameState.user.coils += 200;
                updateUserUI();
                saveUserData();
                showNotification('Friend invitation sent! +200 Coils bonus', 'success');
            }, 1000);
        }

        // Ad System
        function showAd(callback) {
            const modal = document.getElementById('adModal');
            const timer = document.getElementById('adTimer');
            const skipBtn = document.getElementById('adSkip');
            
            modal.style.display = 'flex';
            skipBtn.disabled = true;
            
            let timeLeft = 5;
            timer.textContent = timeLeft;
            
            const adInterval = setInterval(() => {
                timeLeft--;
                timer.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(adInterval);
                    skipBtn.disabled = false;
                    skipBtn.textContent = 'Continue';
                    skipBtn.onclick = () => {
                        modal.style.display = 'none';
                        callback();
                    };
                }
            }, 1000);
        }

        function skipAd() {
            document.getElementById('adModal').style.display = 'none';
        }

        // Lucky Spin Game
        function startSpin() {
            if (gameState.user.coils < 100) {
                showNotification('Not enough coils! You need 100 coils to spin.', 'error');
                return;
            }
            
            showAd(() => {
                performSpin();
            });
        }

        function performSpin() {
            gameState.user.coils -= 100;
            gameState.stats.gamesPlayed++;
            
            const wheel = document.getElementById('spinWheel');
            const btn = document.getElementById('spinBtn');
            const result = document.getElementById('spinResult');
            
            btn.disabled = true;
            btn.textContent = 'SPINNING...';
            result.innerHTML = '<div style="color: var(--primary-gold);">🎰 The wheel is spinning... 🎰</div>';
            
            // Random rotation
            const rotations = 5 + Math.random() * 5; // 5-10 full rotations
            const finalAngle = Math.random() * 360;
            const totalRotation = (rotations * 360) + finalAngle;
            
            wheel.style.transform = `rotate(${totalRotation}deg)`;
            
            setTimeout(() => {
                const prizes = [
                    { name: 'JACKPOT!', value: 1000, chance: 5 },
                    { name: 'Big Win!', value: 500, chance: 10 },
                    { name: 'Great!', value: 300, chance: 15 },
                    { name: 'Nice!', value: 200, chance: 20 },
                    { name: 'Good!', value: 150, chance: 25 },
                    { name: 'Win!', value: 100, chance: 15 },
                    { name: 'Small', value: 50, chance: 8 },
                    { name: 'Try Again', value: 25, chance: 2 }
                ];
                
                // Weighted random selection
                const totalChance = prizes.reduce((sum, prize) => sum + prize.chance, 0);
                let random = Math.random() * totalChance;
                let selectedPrize = prizes[prizes.length - 1];
                
                for (const prize of prizes) {
                    random -= prize.chance;
                    if (random <= 0) {
                        selectedPrize = prize;
                        break;
                    }
                }
                
                gameState.user.coils += selectedPrize.value;
                if (selectedPrize.value >= 200) gameState.stats.totalWins++;
                
                result.innerHTML = `
                    <div style="color: var(--primary-gold); font-size: 24px; margin-bottom: 10px;">
                        🎉 ${selectedPrize.name} 🎉
                    </div>
                    <div style="color: var(--success-green); font-size: 20px;">
                        +${selectedPrize.value} Coils!
                    </div>
                `;
                
                btn.disabled = false;
                btn.textContent = 'SPIN AGAIN! (100 Coils)';
                
                updateUserUI();
                saveUserData();
                showNotification(`${selectedPrize.name}: +${selectedPrize.value} Coils`, 'success');
            }, 4000);
        }

        // Math Pro Game
        let mathGameState = {
            currentQuestion: 0,
            score: 0,
            streak: 0,
            timeLeft: 15,
            timer: null,
            isActive: false
        };

        function startMathGame() {
            if (gameState.user.coils < 50) {
                showNotification('Not enough coils! You need 50 coils to play.', 'error');
                return;
            }
            
            gameState.user.coils -= 50;
            gameState.stats.gamesPlayed++;
            
            mathGameState = {
                currentQuestion: 1,
                score: 0,
                streak: 0,
                timeLeft: 15,
                timer: null,
                isActive: true
            };
            
            updateUserUI();
            generateMathQuestion();
            startMathTimer();
        }

        function generateMathQuestion() {
            if (!mathGameState.isActive) return;
            
            const operations = ['+', '-', '*'];
            const operation = operations[Math.floor(Math.random() * operations.length)];
            
            let num1, num2, correctAnswer;
            const difficulty = Math.min(Math.floor(mathGameState.currentQuestion / 3) + 1, 5);
            
            switch(operation) {
                case '+':
                    num1 = Math.floor(Math.random() * (10 * difficulty)) + 1;
                    num2 = Math.floor(Math.random() * (10 * difficulty)) + 1;
                    correctAnswer = num1 + num2;
                    break;
                case '-':
                    num1 = Math.floor(Math.random() * (20 * difficulty)) + (10 * difficulty);
                    num2 = Math.floor(Math.random() * (10 * difficulty)) + 1;
                    correctAnswer = num1 - num2;
                    break;
                case '*':
                    num1 = Math.floor(Math.random() * (3 * difficulty)) + 1;
                    num2 = Math.floor(Math.random() * (3 * difficulty)) + 1;
                    correctAnswer = num1 * num2;
                    break;
            }
            
            mathGameState.currentAnswer = correctAnswer;
            
            document.getElementById('mathQuestion').textContent = `${num1} ${operation} ${num2} = ?`;
            
            // Generate options
            const options = [correctAnswer];
            while(options.length < 4) {
                let wrongAnswer = correctAnswer + Math.floor(Math.random() * 20) - 10;
                if (wrongAnswer > 0 && !options.includes(wrongAnswer)) {
                    options.push(wrongAnswer);
                }
            }
            
            // Shuffle options
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }
            
            const optionsContainer = document.getElementById('mathOptions');
            optionsContainer.innerHTML = '';
            
            options.forEach(option => {
                const btn = document.createElement('button');
                btn.className = 'math-option';
                btn.textContent = option;
                btn.onclick = () => checkMathAnswer(option);
                optionsContainer.appendChild(btn);
            });
            
            mathGameState.timeLeft = 15;
            updateMathUI();
        }

        function startMathTimer() {
            mathGameState.timer = setInterval(() => {
                mathGameState.timeLeft--;
                updateMathUI();
                
                if (mathGameState.timeLeft <= 0) {
                    checkMathAnswer(null); // Time's up
                }
            }, 1000);
        }

        function checkMathAnswer(selectedAnswer) {
            if (!mathGameState.isActive) return;
            
            clearInterval(mathGameState.timer);
            
            const isCorrect = selectedAnswer === mathGameState.currentAnswer;
            
            if (isCorrect) {
                mathGameState.score += 100 + (mathGameState.streak * 20);
                mathGameState.streak++;
                
                const timeBonus = mathGameState.timeLeft * 5;
                const coilReward = 25 + timeBonus;
                gameState.user.coils += coilReward;
                
                showNotification(`Correct! +${coilReward} Coils (Streak: ${mathGameState.streak})`, 'success');
            } else {
                mathGameState.streak = 0;
                showNotification(selectedAnswer === null ? 'Time\'s up!' : 'Wrong answer!', 'error');
            }
            
            mathGameState.currentQuestion++;
            
            if (mathGameState.currentQuestion <= 10) {
                setTimeout(() => {
                    generateMathQuestion();
                    startMathTimer();
                }, 2000);
            } else {
                endMathGame();
            }
            
            updateMathUI();
            updateUserUI();
        }

        function endMathGame() {
            mathGameState.isActive = false;
            clearInterval(mathGameState.timer);
            
            if (mathGameState.score > gameState.stats.mathScore) {
                gameState.stats.mathScore = mathGameState.score;
                gameState.stats.totalWins++;
            }
            
            const finalBonus = Math.floor(mathGameState.score / 10);
            gameState.user.coils += finalBonus;
            
            document.getElementById('mathQuestion').textContent = 'Game Complete!';
            document.getElementById('mathOptions').innerHTML = `
                <div style="grid-column: 1/-1; text-align: center; color: var(--primary-gold); padding: 20px;">
                    <h3>Final Score: ${mathGameState.score}</h3>
                    <p>Bonus: +${finalBonus} Coils</p>
                    <button class="math-option" onclick="startMathGame()" style="margin-top: 15px;">Play Again</button>
                </div>
            `;
            
            updateUserUI();
            saveUserData();
            showNotification(`Math game complete! Final score: ${mathGameState.score}`, 'success');
        }

        function updateMathUI() {
            document.getElementById('mathCurrentScore').textContent = mathGameState.score;
            document.getElementById('mathStreak').textContent = mathGameState.streak;
            document.getElementById('mathTimer').textContent = mathGameState.timeLeft;
        }

        // Venus Fortune Game
        let venusGameState = {
            selectedCard: -1,
            winningCard: -1,
            isActive: false
        };

        function startVenusFortune() {
            if (gameState.user.coils < 100) {
                showNotification('Not enough coils! You need 100 coils to play.', 'error');
                return;
            }
            
            showAd(() => {
                performVenusFortune();
            });
        }

        function performVenusFortune() {
            gameState.user.coils -= 100;
            gameState.stats.gamesPlayed++;
            
            venusGameState.winningCard = Math.floor(Math.random() * 6);
            venusGameState.isActive = true;
            
            document.getElementById('fortuneResult').innerHTML = '<div style="color: var(--primary-gold);">Select a card to reveal your fortune!</div>';
            
            updateUserUI();
        }

        function selectFortuneCard(cardIndex) {
            if (!venusGameState.isActive) {
                showNotification('Start a new game first!', 'warning');
                return;
            }
            
            venusGameState.selectedCard = cardIndex;
            venusGameState.isActive = false;
            
            const cards = document.querySelectorAll('.fortune-card');
            cards.forEach((card, index) => {
                if (index === cardIndex) {
                    if (index === venusGameState.winningCard) {
                        card.textContent = '💎';
                        card.style.background = 'linear-gradient(135deg, var(--primary-gold), #FFA500)';
                    } else {
                        card.textContent = '💔';
                        card.style.background = 'linear-gradient(135deg, var(--danger-red), #DC2626)';
                    }
                } else if (index === venusGameState.winningCard) {
                    card.textContent = '💎';
                    card.style.background = 'linear-gradient(135deg, var(--success-green), #059669)';
                }
                card.classList.add('revealed');
            });
            
            if (cardIndex === venusGameState.winningCard) {
                const prize = 250 + Math.floor(Math.random() * 250);
                gameState.user.coils += prize;
                gameState.stats.totalWins++;
                
                document.getElementById('fortuneResult').innerHTML = `
                    <div style="color: var(--primary-gold); font-size: 24px; margin-bottom: 10px;">
                        🎉 Fortune Smiles Upon You! 🎉
                    </div>
                    <div style="color: var(--success-green); font-size: 20px;">
                        +${prize} Coils!
                    </div>
                `;
                
                showNotification(`Fortune won! +${prize} Coils`, 'success');
            } else {
                document.getElementById('fortuneResult').innerHTML = `
                    <div style="color: var(--danger-red); font-size: 20px; margin-bottom: 10px;">
                        💔 Not This Time 💔
                    </div>
                    <div style="color: var(--text-muted);">
                        Better luck next time!
                    </div>
                `;
                
                showNotification('Better luck next time!', 'error');
            }
            
            setTimeout(() => {
                resetVenusGame();
            }, 3000);
            
            updateUserUI();
            saveUserData();
        }

        function resetVenusGame() {
            const cards = document.querySelectorAll('.fortune-card');
            cards.forEach(card => {
                card.textContent = '🔮';
                card.style.background = 'linear-gradient(135deg, var(--secondary-purple), #A855F7)';
                card.classList.remove('revealed');
            });
            
            document.getElementById('fortuneResult').innerHTML = '';
            venusGameState = { selectedCard: -1, winningCard: -1, isActive: false };
        }

        // Point King Game
        let pointKingState = {
            score: 0,
            multiplier: 1,
            timeLeft: 30,
            timer: null,
            isActive: false,
            combo: 0,
            lastClickTime: 0
        };

        function startPointKing() {
            if (gameState.user.coils < 60) {
                showNotification('Not enough coils! You need 60 coils to play.', 'error');
                return;
            }
            
            gameState.user.coils -= 60;
            gameState.stats.gamesPlayed++;
            
            pointKingState = {
                score: 0,
                multiplier: 1,
                timeLeft: 30,
                timer: null,
                isActive: true,
                combo: 0,
                lastClickTime: Date.now()
            };
            
            document.getElementById('clickBtn').textContent = 'CLICK FOR POINTS!';
            document.getElementById('clickBtn').onclick = clickForPoints;
            
            pointKingState.timer = setInterval(() => {
                pointKingState.timeLeft--;
                updatePointKingUI();
                
                if (pointKingState.timeLeft <= 0) {
                    endPointKingGame();
                }
            }, 1000);
            
            // Add keyboard listener
            document.addEventListener('keydown', handlePointKingKeyPress);
            
            updateUserUI();
            updatePointKingUI();
        }

        function handlePointKingKeyPress(event) {
            if (event.code === 'Space' && pointKingState.isActive) {
                event.preventDefault();
                clickForPoints();
            }
        }

        function clickForPoints() {
            if (!pointKingState.isActive) return;
            
            const now = Date.now();
            const timeSinceLastClick = now - pointKingState.lastClickTime;
            
            // Base points
            let points = Math.floor(Math.random() * 20) + 10;
            
            // Combo system
            if (timeSinceLastClick < 300) {
                pointKingState.combo = Math.min(pointKingState.combo + 1, 50);
            } else if (timeSinceLastClick > 1000) {
                pointKingState.combo = Math.max(0, pointKingState.combo - 1);
            }
            
            // Apply combo bonus
            points += Math.floor(pointKingState.combo / 2);
            
            // Random multiplier boost
            if (Math.random() < 0.1) {
                pointKingState.multiplier = 2;
                setTimeout(() => {
                    pointKingState.multiplier = 1;
                    updatePointKingUI();
                }, 2000);
            }
            
            points *= pointKingState.multiplier;
            pointKingState.score += points;
            pointKingState.lastClickTime = now;
            
            // Visual feedback
            const btn = document.getElementById('clickBtn');
            btn.style.transform = 'scale(0.9)';
            setTimeout(() => {
                btn.style.transform = 'scale(1)';
            }, 100);
            
            updatePointKingUI();
        }

        function updatePointKingUI() {
            document.getElementById('pointKingScore').textContent = pointKingState.score;
            document.getElementById('pointKingMultiplier').textContent = `x${pointKingState.multiplier}`;
            document.getElementById('pointKingTime').textContent = pointKingState.timeLeft;
            document.getElementById('pointDisplay').textContent = pointKingState.score.toLocaleString();
        }

        function endPointKingGame() {
            pointKingState.isActive = false;
            clearInterval(pointKingState.timer);
            
            // Remove keyboard listener
            document.removeEventListener('keydown', handlePointKingKeyPress);
            
            if (pointKingState.score > gameState.stats.pointScore) {
                gameState.stats.pointScore = pointKingState.score;
                gameState.stats.totalWins++;
            }
            
            const coilReward = Math.floor(pointKingState.score / 10);
            gameState.user.coils += coilReward;
            
            document.getElementById('clickBtn').textContent = 'GAME COMPLETE!';
            document.getElementById('clickBtn').onclick = startPointKing;
            document.getElementById('pointDisplay').innerHTML = `
                <div style="font-size: 24px; color: var(--primary-gold);">Game Complete!</div>
                <div style="font-size: 18px; margin-top: 10px;">Final Score: ${pointKingState.score.toLocaleString()}</div>
                <div style="font-size: 16px; color: var(--success-green);">+${coilReward} Coils</div>
            `;
            
            setTimeout(() => {
                document.getElementById('clickBtn').textContent = 'PLAY AGAIN';
                document.getElementById('pointDisplay').textContent = 'Click to Start!';
            }, 5000);
            
            updateUserUI();
            saveUserData();
            showNotification(`Point King complete! Final score: ${pointKingState.score.toLocaleString()}`, 'success');
        }

        // Lucky Number Game
        let luckyNumberState = {
            targetNumber: Math.floor(Math.random() * 100) + 1,
            jackpot: 5000,
            lastReset: Date.now()
        };

        function makeGuess() {
            const guess = parseInt(document.getElementById('numberGuess').value);
            
            if (!guess || guess < 1 || guess > 100) {
                showNotification('Please enter a number between 1 and 100!', 'warning');
                return;
            }
            
            if (gameState.user.coils < 100) {
                showNotification('Not enough coils! You need 100 coils to make a guess.', 'error');
                return;
            }
            
            gameState.user.coils -= 100;
            gameState.stats.gamesPlayed++;
            luckyNumberState.jackpot += 50; // Jackpot grows
            
            const resultDiv = document.getElementById('guessResult');
            
            if (guess === luckyNumberState.targetNumber) {
                // Winner!
                gameState.user.coils += luckyNumberState.jackpot;
                gameState.stats.totalWins++;
                gameState.stats.luckyNumberWins++;
                
                resultDiv.innerHTML = `
                    <div style="color: var(--primary-gold); font-size: 28px; margin-bottom: 15px;">
                        🎉 JACKPOT WINNER! 🎉
                    </div>
                    <div style="color: var(--success-green); font-size: 24px; margin-bottom: 10px;">
                        +${luckyNumberState.jackpot.toLocaleString()} Coils!
                    </div>
                    <div style="color: var(--text-light);">
                        The lucky number was ${luckyNumberState.targetNumber}!
                    </div>
                `;
                
                // Reset for next round
                luckyNumberState.targetNumber = Math.floor(Math.random() * 100) + 1;
                luckyNumberState.jackpot = 5000;
                
                showNotification(`JACKPOT! You won ${luckyNumberState.jackpot.toLocaleString()} coils!`, 'success');
            } else {
                // Wrong guess
                let hint = '';
                if (Math.abs(guess - luckyNumberState.targetNumber) <= 5) {
                    hint = '🔥 Very close!';
                } else if (Math.abs(guess - luckyNumberState.targetNumber) <= 15) {
                    hint = '🎯 Getting warmer!';
                } else if (guess < luckyNumberState.targetNumber) {
                    hint = '📈 Too low!';
                } else {
                    hint = '📉 Too high!';
                }
                
                resultDiv.innerHTML = `
                    <div style="color: var(--danger-red); font-size: 20px; margin-bottom: 10px;">
                        ❌ Not quite right!
                    </div>
                    <div style="color: var(--primary-gold); font-size: 18px; margin-bottom: 10px;">
                        ${hint}
                    </div>
                    <div style="color: var(--text-muted);">
                        Try again in the next round!
                    </div>
                `;
                
                showNotification(`Wrong guess! ${hint}`, 'error');
            }
            
            document.getElementById('numberGuess').value = '';
            document.getElementById('jackpotAmount').textContent = luckyNumberState.jackpot.toLocaleString() + ' Coils';
            
            updateUserUI();
            saveUserData();
        }

        // Chat System
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            const messagesContainer = document.getElementById('chatMessages');
            const messageEl = document.createElement('div');
            messageEl.className = 'chat-message own';
            messageEl.innerHTML = `
                <div class="message-header">
                    <span class="message-author">${gameState.user.username}</span>
                    <span class="message-time">now</span>
                </div>
                <div class="message-content">${message}</div>
            `;
            
            messagesContainer.appendChild(messageEl);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            input.value = '';
            
            // Simulate other players responding
            setTimeout(() => {
                const responses = [
                    'Nice one!',
                    'Good luck everyone!',
                    'Just won big in Lucky Spin! 🎰',
                    'Anyone up for Math Pro?',
                    'This game is addictive! 😄',
                    'Great community here! 👍'
                ];
                
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                const botNames = ['GameMaster', 'LuckyPlayer', 'MathWiz', 'SpinKing', 'PointHunter'];
                const botName = botNames[Math.floor(Math.random() * botNames.length)];
                
                const botMessageEl = document.createElement('div');
                botMessageEl.className = 'chat-message';
                botMessageEl.innerHTML = `
                    <div class="message-header">
                        <span class="message-author">${botName}</span>
                        <span class="message-time">now</span>
                    </div>
                    <div class="message-content">${randomResponse}</div>
                `;
                
                messagesContainer.appendChild(botMessageEl);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 1000 + Math.random() * 3000);
        }

        // Profile Management
        function editProfile() {
            const newUsername = prompt('Enter new username:', gameState.user.username);
            if (newUsername && newUsername.trim()) {
                gameState.user.username = newUsername.trim();
                updateUserUI();
                saveUserData();
                showNotification('Profile updated successfully!', 'success');
            }
        }

        function changePassword() {
            if (gameState.user.isGuest) {
                showNotification('Guest users cannot change password. Please register first!', 'warning');
                return;
            }
            
            const currentPassword = prompt('Enter current password:');
            if (currentPassword) {
                const newPassword = prompt('Enter new password:');
                if (newPassword) {
                    showNotification('Password changed successfully!', 'success');
                }
            }
        }

        function viewGameHistory() {
            alert(`Game History for ${gameState.user.username}:
            
Games Played: ${gameState.stats.gamesPlayed}
Total Wins: ${gameState.stats.totalWins}
Math Pro High Score: ${gameState.stats.mathScore}
Point King High Score: ${gameState.stats.pointScore}
Lucky Number Wins: ${gameState.stats.luckyNumberWins}
Current Login Streak: ${gameState.user.loginStreak} days`);
        }

        // Data Management
        function saveUserData() {
            try {
                localStorage.setItem('coilChampionsData', JSON.stringify(gameState));
            } catch (error) {
                console.warn('Could not save user data:', error);
            }
        }

        function loadUserData() {
            try {
                const savedData = localStorage.getItem('coilChampionsData');
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    // Merge saved data with current state
                    Object.assign(gameState, parsedData);
                }
            } catch (error) {
                console.warn('Could not load user data:', error);
            }
        }

        // Notification System
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Redemption System
        let currentRedemption = null;

        function updateRedeemCards() {
            const cards = document.querySelectorAll('.redeem-card');
            cards.forEach(card => {
                const costText = card.querySelector('.redeem-cost').textContent;
                const cost = parseInt(costText.replace(/[^\d]/g, ''));
                
                if (gameState.user.coils < cost) {
                    card.classList.add('insufficient');
                } else {
                    card.classList.remove('insufficient');
                }
            });
        }

        function selectRedemption(type, cost, value) {
            if (gameState.user.coils < cost) {
                showNotification('Insufficient coils for this redemption!', 'error');
                return;
            }
            
            currentRedemption = { type, cost, value };
            
            const modal = document.getElementById('redeemModal');
            const icons = {
                kpay: '💵',
                mobile: '📱',
                gaming: '🎮',
                gift: '🎁'
            };
            
            const titles = {
                kpay: `$${value} KPay Cash`,
                mobile: `$${value} Mobile Credit`,
                gaming: `$${value} Gaming Credit`,
                gift: `$${value} Gift Card`
            };
            
            document.getElementById('redeemModalIcon').textContent = icons[type];
            document.getElementById('redeemModalReward').textContent = titles[type];
            document.getElementById('redeemModalCost').textContent = `Cost: ${cost.toLocaleString()} Coils`;
            
            // Show appropriate form
            const kpayForm = document.getElementById('kpayForm');
            const otherForm = document.getElementById('otherForm');
            
            if (type === 'kpay') {
                kpayForm.style.display = 'block';
                otherForm.style.display = 'none';
                
                // Pre-fill KPay number if available
                if (gameState.user.kpay) {
                    document.getElementById('redeemKpay').value = gameState.user.kpay;
                    document.getElementById('confirmKpay').value = gameState.user.kpay;
                }
            } else {
                kpayForm.style.display = 'none';
                otherForm.style.display = 'block';
                
                // Pre-fill email
                document.getElementById('redeemEmail').value = gameState.user.email;
            }
            
            modal.style.display = 'flex';
        }

        function cancelRedemption() {
            document.getElementById('redeemModal').style.display = 'none';
            currentRedemption = null;
            
            // Clear form fields
            document.getElementById('redeemKpay').value = '';
            document.getElementById('confirmKpay').value = '';
            document.getElementById('redeemPhone').value = '';
            document.getElementById('redeemEmail').value = '';
        }

        function confirmRedemption() {
            if (!currentRedemption) return;
            
            const { type, cost, value } = currentRedemption;
            
            // Validate form fields
            if (type === 'kpay') {
                const kpay = document.getElementById('redeemKpay').value.trim();
                const confirmKpay = document.getElementById('confirmKpay').value.trim();
                
                if (!kpay || !confirmKpay) {
                    showNotification('Please fill in all KPay fields!', 'error');
                    return;
                }
                
                if (kpay !== confirmKpay) {
                    showNotification('KPay numbers do not match!', 'error');
                    return;
                }
                
                if (!/^\d{10,15}$/.test(kpay)) {
                    showNotification('Please enter a valid KPay number!', 'error');
                    return;
                }
            } else {
                const phone = document.getElementById('redeemPhone').value.trim();
                const email = document.getElementById('redeemEmail').value.trim();
                
                if (!phone || !email) {
                    showNotification('Please fill in all fields!', 'error');
                    return;
                }
                
                if (!/^\d{10,15}$/.test(phone)) {
                    showNotification('Please enter a valid phone number!', 'error');
                    return;
                }
                
                if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                    showNotification('Please enter a valid email address!', 'error');
                    return;
                }
            }
            
            // Process redemption
            gameState.user.coils -= cost;
            gameState.redemptions.totalRedeemed += value;
            
            const redemption = {
                id: 'redeem_' + Date.now(),
                type: type,
                title: document.getElementById('redeemModalReward').textContent,
                value: value,
                cost: cost,
                status: type === 'kpay' ? 'completed' : 'pending',
                date: new Date().toISOString(),
                kpay: type === 'kpay' ? document.getElementById('redeemKpay').value : null,
                phone: type !== 'kpay' ? document.getElementById('redeemPhone').value : null,
                email: type !== 'kpay' ? document.getElementById('redeemEmail').value : null
            };
            
            gameState.redemptions.history.unshift(redemption);
            
            // Keep only last 10 redemptions
            if (gameState.redemptions.history.length > 10) {
                gameState.redemptions.history = gameState.redemptions.history.slice(0, 10);
            }
            
            updateRedemptionHistory();
            updateUserUI();
            saveUserData();
            
            document.getElementById('redeemModal').style.display = 'none';
            
            if (type === 'kpay') {
                showNotification(`KPay redemption successful! $${value} sent to your KPay wallet.`, 'success');
            } else {
                showNotification(`Redemption submitted! You'll receive your ${document.getElementById('redeemModalReward').textContent} within 1-3 business days.`, 'success');
            }
            
            currentRedemption = null;
            
            // Simulate KPay instant processing
            if (type === 'kpay') {
                setTimeout(() => {
                    showNotification('💰 KPay transfer completed successfully!', 'success');
                }, 2000);
            }
        }

        function updateRedemptionHistory() {
            const historyContainer = document.getElementById('redemptionHistory');
            
            if (gameState.redemptions.history.length === 0) {
                historyContainer.innerHTML = `
                    <div style="text-align: center; color: var(--text-muted); padding: 40px;">
                        <div style="font-size: 48px; margin-bottom: 15px;">🎁</div>
                        <p>No redemptions yet</p>
                        <p style="font-size: 14px;">Start earning coils and redeem amazing rewards!</p>
                    </div>
                `;
                return;
            }
            
            historyContainer.innerHTML = gameState.redemptions.history.map(redemption => {
                const date = new Date(redemption.date);
                const timeAgo = getTimeAgo(date);
                
                const icons = {
                    kpay: '💵',
                    mobile: '📱',
                    gaming: '🎮',
                    gift: '🎁'
                };
                
                return `
                    <div class="history-item">
                        <div class="history-icon">${icons[redemption.type]}</div>
                        <div class="history-info">
                            <div class="history-title">${redemption.title}</div>
                            <div class="history-date">${timeAgo}</div>
                        </div>
                        <div class="history-status ${redemption.status}">
                            ${redemption.status === 'completed' ? '✅ Completed' : 
                              redemption.status === 'pending' ? '⏳ Pending' : '❌ Failed'}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            if (diffInSeconds < 60) return 'Just now';
            if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} min ago`;
            if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)} hours ago`;
            if (diffInSeconds < 604800) return `${Math.floor(diffInSeconds / 86400)} days ago`;
            return `${Math.floor(diffInSeconds / 604800)} weeks ago`;
        }

        // Initialize connection check
        checkConnection();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96a6ca71d118fd68',t:'MTc1NDQwMjExMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
